from pwn import connect
import decimal

e = 65537
server = connect("130.192.5.212", 6646)

#plaintext = 1
plaintext = -1
print(plaintext)

c = int(server.recvline())

#server.sendline(b'e'+str(plaintext).encode())
#print(b'e'+str(plaintext).encode())

#remainder = int(server.recvline())
#print(remainder)

#plaintext = (plaintext**e - remainder -1)
#print(plaintext)

server.sendline(b'e'+str(plaintext).encode())
print((b'e'+str(plaintext).encode()))

n = int(server.recvline())+1
print(n)

c2 = (pow(2,e)*c) % n
server.sendline(b'd'+str(c2).encode())
m2 = int(server.recvline())
m = m2 // 2
m_bytes = m.to_bytes(m.bit_length()//8+1, 'big')
print(m_bytes.decode())