from pwn import *

server = remote("130.192.5.212", "6531")

for i in range(128):
    text1 = server.recvline().decode()
    print(text1)
    otp_line = server.recvline().decode()
    otp = otp_line[19:].strip()
    server.recv(1024).decode()  #input
    print("opt="+otp)

    server.sendline(otp.encode())
    output_line = server.recvline().decode()
    print(output_line)
    output = output_line[8:]
    print(output)
    print(output[:32])
    print(output[32:])

    print(server.recvline().decode()) #ECB or CBC?
    if (output[:32] == output[32:64]):
        print("ECB")
        server.sendline("ECB".encode())
    else:
        print("CBC")
        server.sendline("CBC".encode())
    print(server.recv(1024).decode())