import base64
import json
from Crypto.Cipher import ChaCha20

""" def make_cipher():
    nonce = base64.b64decode("ELQUwiZE3UKNaz0W")
    cipher = ChaCha20.new(key=key, nonce=nonce)
    return nonce, cipher
 """

plaintext = json.dumps({
    "username": "adminadminadminadminadmin"
}).encode('utf-8')

ciphertext = base64.b64decode("Oh3x2liDm5bJg/K0.9Ma2nSPM7riwvqXu+3Bqoc4xaw1j0VSCR/6hQ55uED4ke6RSjHxHsYE=")

#print(ciphertext)
#print(plaintext)

streamkey = bytes(a ^ b for a, b in zip(plaintext, ciphertext))

#print(streamkey)

token = json.dumps({
    "username": "Kosimo",
    "admin" : True
}).encode('utf-8')

#print(json.loads(token))
#print(token)
enc_token = bytes(a ^ b for a, b in zip(token, streamkey))

print(base64.b64encode(enc_token))

dec_token = bytes(a ^ b for a, b in zip(streamkey, enc_token))

user = json.loads(dec_token)
    
if user.get("admin", False) == True:
    print("True")
else:
    print("False")

print(f"{base64.b64encode(enc_token).decode()}")