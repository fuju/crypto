from pwn import *
import random
from Crypto.Util.strxor import strxor

server = connect("130.192.5.212", "6561")

server.recvline()
server.sendline(b'1')
#random.seed(1)

server.recvline()
ciphertext = server.recvline()
print("ciphertext="+str(ciphertext))
ciphertext_bytes = bytes.fromhex(ciphertext.decode())
print(server.recv(1024))
server.sendline(b'y')
print(server.recv(1024))
input = ("0"*46).encode() #because chiper is long 46 bytes
server.sendline(input)
output = server.recvline()
print(output)
output_bytes = bytes.fromhex(output.decode())
keystream = strxor(output_bytes, input)
flag = strxor(keystream, ciphertext_bytes)
print(flag.decode())