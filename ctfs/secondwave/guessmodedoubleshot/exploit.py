from pwn import *

server = connect("130.192.5.212", "6532")

for i in range(128):
    server.recv(1024) #challenge i input:
    server.sendline(('0'*64).encode())
    ans1 = server.recvline().decode().strip()[8:]

    server.recv(1024) #input
    server.sendline(('1'*32).encode() + ('0'*32).encode())
    ans2 = server.recvline().decode().strip()[8:]

    server.recvline() #what did i use?

    if ans1[32:64] == ans2[32:64]:
        print("ECB")
        server.sendline(b'ECB')
    else:
        print("CBC")
        server.sendline(b'CBC')

    print(server.recvline().decode())

print(server.recvline().decode())